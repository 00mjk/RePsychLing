<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Reinhold Kliegl" />

<meta name="date" content="2015-03-24" />

<title>RePsychLing Kliegl et al. (2011)</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">RePsychLing Kliegl et al. (2011)</h1>
<h4 class="author"><em>Reinhold Kliegl</em></h4>
<h4 class="date"><em>2015-03-24</em></h4>
</div>


<p>This is a set of follow-up analyses of the data described in <span class="citation">Kliegl et al. (2011)</span></p>
<p>We are using the final set of data used in that paper, that is after filtering a few outlier responses, defining <code>sdif</code> contrasts for factor <code>tar</code> and corresponding vector-valued contrasts <code>spt</code>, <code>c2</code>, <code>c3</code> from the model matrix. The dataframe also includes transformations of the response time, <code>rt</code> (<code>lrt=log(rt)</code>, <code>srt=sqrt(rt)</code>, <code>rrt=1000/rt</code> (note change in effect direction), <code>prt=rt^0.4242424</code> (acc to boxcox); subj = factor(id)).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(KWDYZ)</code></pre>
<pre><code>'data.frame':   28710 obs. of  12 variables:
 $ item: Factor w/ 480 levels &quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,..: 32 43 75 87 100 131 155 195 209 216 ...
 $ tar : Factor w/ 4 levels &quot;val&quot;,&quot;sod&quot;,&quot;dos&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
  ..- attr(*, &quot;contrasts&quot;)= num [1:4, 1:3] -0.75 0.25 0.25 0.25 -0.5 -0.5 0.5 0.5 0.25 0.25 ...
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : chr  &quot;val&quot; &quot;sod&quot; &quot;dos&quot; &quot;dod&quot;
  .. .. ..$ : chr  &quot;.spt&quot; &quot;.obj&quot; &quot;.att&quot;
 $ dir : Factor w/ 2 levels &quot;hor&quot;,&quot;ver&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ rt  : num  506 490 519 460 384 ...
 $ subj: Factor w/ 61 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ c1  : num  0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 ...
 $ c2  : num  0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 ...
 $ c3  : num  -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 ...
 $ srt : num  0.506 0.49 0.519 0.46 0.384 ...
 $ lrt : num  6.23 6.19 6.25 6.13 5.95 ...
 $ qrt : num  22.5 22.1 22.8 21.4 19.6 ...
 $ prt : num  14 13.8 14.2 13.5 12.5 ...</code></pre>
<div id="models" class="section level2">
<h2>Models</h2>
<div id="maximal-linear-mixed-model-maxlmm" class="section level3">
<h3>Maximal linear mixed model (<em>maxLMM</em>)</h3>
<p>The maximal model (<em>maxLMM</em>) reported in this paper is actually an overparameterized/degenerate model. Here we show how to identify the overparameterization and how we tried to deal with it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m0 &lt;-<span class="st"> </span><span class="kw">lmer</span>(rt ~<span class="st"> </span><span class="dv">1</span>+c1+c2+c3 +<span class="st"> </span>(<span class="dv">1</span>+c1+c2+c3|subj), KWDYZ, <span class="dt">REML=</span><span class="ot">FALSE</span>))</code></pre>
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: rt ~ 1 + c1 + c2 + c3 + (1 + c1 + c2 + c3 | subj)
   Data: KWDYZ

      AIC       BIC    logLik  deviance  df.resid 
 325839.5  325963.5 -162904.8  325809.5     28695 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.4945 -0.5641 -0.0836  0.4617  5.6038 

Random effects:
 Groups   Name        Variance Std.Dev. Corr             
 subj     (Intercept) 3047.06  55.20                     
          c1           540.48  23.25     0.60            
          c2           115.65  10.75    -0.13 -0.01      
          c3            90.45   9.51    -0.25 -0.85  0.36
 Residual             4876.90  69.83                     
Number of obs: 28710, groups:  subj, 61

Fixed effects:
            Estimate Std. Error t value
(Intercept)  389.734      7.091   54.96
c1            33.782      3.287   10.28
c2            13.985      2.306    6.07
c3             2.747      2.214    1.24

Correlation of Fixed Effects:
   (Intr) c1     c2    
c1  0.561              
c2 -0.078 -0.229       
c3 -0.136 -0.422  0.456</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">rePCA</span>(m0))</code></pre>
<pre><code>$subj
Importance of components:
                         [,1]   [,2]    [,3]      [,4]
Standard deviation     0.8200 0.2821 0.16110 6.941e-08
Proportion of Variance 0.8644 0.1023 0.03336 0.000e+00
Cumulative Proportion  0.8644 0.9666 1.00000 1.000e+00</code></pre>
<p>The principal components analysis (PCA) of the estimated unconditional variance-covariance matrix indicates one dimension in the space of vector-valued random effects has no variability.</p>
<p>That is, the model is degenerate.</p>
</div>
<div id="evaluation-of-singular-value-decomposition-svd-for-maxlmm" class="section level3">
<h3>Evaluation of singular value decomposition (svd) for <em>maxLMM</em></h3>
<p>The parameters are in the Cholesky factors of two relative covariance matrices, each of size 4 by 4. There are 10 parameters in each of these matices. To examine the structure of the relative covariance matrices for the random effects we generate a 4 by 4 lower triangular matrix from the first 10 elements. This matrix is the (lower) Cholesky factor of the relative covariance matrix for the random effects by <code>subj</code>.</p>
<p>The singular values of the relative covariance factor are</p>
<pre class="sourceCode r"><code class="sourceCode r">chf0 &lt;-<span class="st"> </span><span class="kw">getME</span>(m0,<span class="st">&quot;Tlist&quot;</span>)[[<span class="dv">1</span>]]
<span class="kw">zapsmall</span>(chf0)</code></pre>
<pre><code>           [,1]       [,2]      [,3]  [,4]
[1,]  0.7904395  0.0000000 0.0000000 0e+00
[2,]  0.2010534  0.2653325 0.0000000 0e+00
[3,] -0.0202276  0.0137712 0.1520395 0e+00
[4,] -0.0338908 -0.1191284 0.0566182 1e-07</code></pre>
<p>To examine the rank of the relative covariance matrix we evaluate the singular value decomposition of <code>chf0</code></p>
<pre class="sourceCode r"><code class="sourceCode r">sv0 &lt;-<span class="st"> </span><span class="kw">svd</span>(chf0)
sv0$d</code></pre>
<pre><code>[1] 8.19982e-01 2.82055e-01 1.61101e-01 6.94113e-08</code></pre>
<p>We see that that the last value is (close to) zero. These are the relative standard deviations in 4 orthogonal directions in the space of the random effects for <code>subj</code>. The directions are the principal components for this covariance matrix. In one direction there is zero variability. Finally, we get the percentage of variance associated with each component:</p>
<p>Here is a bit more linear algebra on how these values are computed:</p>
<pre class="sourceCode r"><code class="sourceCode r">(xx&lt;-<span class="kw">tcrossprod</span>(chf0))</code></pre>
<pre><code>            [,1]          [,2]          [,3]         [,4]
[1,]  0.62479456  0.1589205365 -0.0159887110 -0.026788597
[2,]  0.15892054  0.1108237803 -0.0004128759 -0.038422492
[3,] -0.01598871 -0.0004128759  0.0237148101  0.007653191
[4,] -0.02678860 -0.0384224921  0.0076531911  0.018545791</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">diag</span>(xx)) </code></pre>
<pre><code>[1] 0.7778789</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(xx)</code></pre>
<pre><code>[1] 0.62479456 0.11082378 0.02371481 0.01854579</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sv0)</code></pre>
<pre><code>List of 3
 $ d: num [1:4] 8.20e-01 2.82e-01 1.61e-01 6.94e-08
 $ u: num [1:4, 1:4] -0.9594 -0.2754 0.0245 0.0558 0.2723 ...
 $ v: num [1:4, 1:4] -9.95e-01 -9.68e-02 8.39e-03 5.52e-09 9.72e-02 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sv0$v</code></pre>
<pre><code>              [,1]          [,2]          [,3]          [,4]
[1,] -9.952693e-01  9.715133e-02 -8.165848e-04 -6.445819e-09
[2,] -9.679176e-02 -9.922415e-01 -7.802708e-02  1.097295e-07
[3,]  8.390684e-03  7.757892e-02 -9.969509e-01 -1.562931e-07
[4,]  5.516987e-09  1.216294e-07 -1.472599e-07  1.000000e+00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">zapsmall</span>(sv0$v)</code></pre>
<pre><code>           [,1]       [,2]       [,3]   [,4]
[1,] -0.9952693  0.0971513 -0.0008166  0e+00
[2,] -0.0967918 -0.9922415 -0.0780271  1e-07
[3,]  0.0083907  0.0775789 -0.9969509 -2e-07
[4,]  0.0000000  0.0000001 -0.0000001  1e+00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sv0$u   <span class="co"># last column is the singular combination of random effects</span></code></pre>
<pre><code>            [,1]        [,2]         [,3]        [,4]
[1,] -0.95941151  0.27225987 -0.004006561 -0.07340347
[2,] -0.27535272 -0.86416228 -0.129529297  0.40078248
[3,]  0.02448189 -0.01359477 -0.947442612 -0.31869785
[4,]  0.05577702  0.42298144 -0.292504027  0.85581366</code></pre>
<p>In principle, the significance of model parameters can be determined with profiling or bootstrapping the model paramters to obtain confidence intervals [e.g., <code>confint(m0, method=&quot;profile&quot;)</code>] does not work for <em>maxLMM</em>. Bootstrapping the parameters [e.g., <code>confint(m0, method=&quot;boot&quot;)</code>] takes very long and yields strange values. Most likely, these are also consequences of the singularity of <em>maxLMM</em>.</p>
</div>
<div id="zero-correlation-parameter-linear-mixed-model-zcpplmm" class="section level3">
<h3>Zero-correlation parameter linear mixed model (zcppLMM)</h3>
<p>One option to reduce the complexity of the <em>maxLMM</em> is to force correlation parameters to zero. This can be accomplished with the new double-bar syntax.</p>
<pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(rt ~<span class="st"> </span><span class="dv">1</span>+c1+c2+c3 +<span class="st"> </span>(<span class="dv">1</span>+c1+c2+c3||subj), KWDYZ, <span class="dt">REML=</span><span class="ot">FALSE</span>)
<span class="kw">VarCorr</span>(m1)</code></pre>
<pre><code> Groups   Name        Std.Dev.
 subj     (Intercept) 54.7121 
 subj.1   c1          23.9711 
 subj.2   c2          10.3932 
 subj.3   c3           8.6088 
 Residual             69.8385 </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">rePCA</span>(m1))</code></pre>
<pre><code>$subj
Importance of components:
                         [,1]   [,2]   [,3]    [,4]
Standard deviation     0.7834 0.3432 0.1488 0.12327
Proportion of Variance 0.7982 0.1532 0.0288 0.01976
Cumulative Proportion  0.7982 0.9514 0.9802 1.00000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m1, m0)  <span class="co"># significant: too much of a reduction</span></code></pre>
<pre><code>Data: KWDYZ
Models:
m1: rt ~ 1 + c1 + c2 + c3 + ((1 | subj) + (0 + c1 | subj) + (0 + 
m1:     c2 | subj) + (0 + c3 | subj))
m0: rt ~ 1 + c1 + c2 + c3 + (1 + c1 + c2 + c3 | subj)
   Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
m1  9 325867 325941 -162924   325849                         
m0 15 325840 325964 -162905   325810 39.058      6  6.973e-07</code></pre>
<p>The PCA analysis reveals no exact singularity for the <em>zcpLMM</em>. This model, however, fits significantly worse than <em>maxLMM</em>. Thus, removing all correlation parameters was too much of a reduction in model complexity. Before checking invidual correlation parameters for inclusion, we check whether any of the variance components are not supported b the data.</p>
<p>The following command takes time, but the results look fine:</p>
<pre class="sourceCode r"><code class="sourceCode r">(m1.ci_profile &lt;-<span class="st"> </span><span class="kw">confint</span>(m1, <span class="dt">method=</span><span class="st">&quot;profile&quot;</span>))</code></pre>
<p>Result:</p>
<pre><code>Computing profile confidence intervals ...
                  2.5 %     97.5 %
 .sig01       46.208468  66.139137
 .sig02       19.646992  29.614386
 .sig03        5.597126  15.166344
 .sig04        3.982159  13.692235
 .sigma       69.269014  70.415812
 (Intercept) 375.731344 403.724376
 c1           27.070830  40.478887
 c2            9.484679  18.518766
 c3           -1.485184   7.059293</code></pre>
<p>The following command takes time, but the results look fine:</p>
<pre class="sourceCode r"><code class="sourceCode r">(m1.ci_boot &lt;-<span class="st"> </span><span class="kw">confint</span>(m1, <span class="dt">method=</span><span class="st">&quot;boot&quot;</span>))</code></pre>
<p>Result:</p>
<pre><code>Computing bootstrap confidence intervals ...
                           2.5 %     97.5 %
 sd_(Intercept)|subj  46.1696994  65.177956
 sd_c1|subj           18.9972281  29.324149
 sd_c2|subj            4.4081808  14.810636
 sd_c3|subj            0.8622058  12.899966
 sigma                69.2213099  70.471296
 (Intercept)         375.0806542 404.386494
 c1                   27.1196532  40.298967
 c2                    9.1330003  18.326448
 c3                   -1.8171621   7.315928</code></pre>
</div>
<div id="drop-lrts-for-vcs-of-maximal-model" class="section level3">
<h3>Drop LRTs for vc’s of maximal model</h3>
<pre class="sourceCode r"><code class="sourceCode r">m2d &lt;-<span class="st"> </span><span class="kw">lmer</span>(rt ~<span class="st"> </span><span class="dv">1</span>+c1+c2+c3 +<span class="st"> </span>(<span class="dv">1</span>+c1+c2|subj), KWDYZ, <span class="dt">REML=</span><span class="ot">FALSE</span>)
<span class="kw">VarCorr</span>(m2d)</code></pre>
<pre><code> Groups   Name        Std.Dev. Corr         
 subj     (Intercept) 55.1986               
          c1          23.1704   0.606       
          c2           9.8385  -0.022  0.422
 Residual             69.8696               </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">rePCA</span>(m2d))</code></pre>
<pre><code>$subj
Importance of components:
                         [,1]    [,2]    [,3]
Standard deviation     0.8180 0.26884 0.11175
Proportion of Variance 0.8876 0.09586 0.01656
Cumulative Proportion  0.8876 0.98344 1.00000</code></pre>
<p>Conclusion: Having both <code>subj.c1</code> and <code>subj.c3</code> as well as correlation parameters in the model generates singular covariance matrix.</p>
</div>
<div id="using-lrtlogrt-or-prt-rtpower-acc-box-cox" class="section level3">
<h3>Using lrt=log(rt) or prt= rt^power (acc Box-Cox)</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">summary</span>(m2i &lt;-<span class="st"> </span><span class="kw">lmer</span>(lrt ~<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span>c1 +<span class="st"> </span>c2 +<span class="st"> </span>c3 +<span class="st"> </span>(<span class="dv">1</span> +<span class="st"> </span>c1 +<span class="st"> </span>c2 +<span class="st"> </span>c3 |<span class="st"> </span>subj), 
                          <span class="dt">REML=</span><span class="ot">FALSE</span>, <span class="dt">data=</span>KWDYZ)), <span class="dt">corr=</span><span class="ot">FALSE</span>)  </code></pre>
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: lrt ~ 1 + c1 + c2 + c3 + (1 + c1 + c2 + c3 | subj)
   Data: KWDYZ

     AIC      BIC   logLik deviance df.resid 
-12752.4 -12628.4   6391.2 -12782.4    28695 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.4894 -0.5032  0.0029  0.5403  4.4284 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr             
 subj     (Intercept) 0.0207652 0.14410                   
          c1          0.0033848 0.05818   0.48            
          c2          0.0007530 0.02744  -0.24 -0.15      
          c3          0.0006221 0.02494  -0.30 -0.93  0.43
 Residual             0.0368543 0.19197                   
Number of obs: 28710, groups:  subj, 61

Fixed effects:
            Estimate Std. Error t value
(Intercept) 5.935828   0.018519   320.5
c1          0.087774   0.008378    10.5
c2          0.036603   0.006180     5.9
c3          0.008611   0.006004     1.4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">rePCA</span>(m2i))</code></pre>
<pre><code>$subj
Importance of components:
                         [,1]   [,2]   [,3]      [,4]
Standard deviation     0.7687 0.2850 0.1432 1.697e-07
Proportion of Variance 0.8531 0.1173 0.0296 0.000e+00
Cumulative Proportion  0.8531 0.9704 1.0000 1.000e+00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">summary</span>(m2j &lt;-<span class="st"> </span><span class="kw">lmer</span>(prt ~<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span>c1 +<span class="st"> </span>c2 +<span class="st"> </span>c3 +<span class="st"> </span>(<span class="dv">1</span> +<span class="st"> </span>c1 +<span class="st"> </span>c2 +<span class="st"> </span>c3 |<span class="st"> </span>subj),
                          <span class="dt">REML=</span><span class="ot">FALSE</span>, <span class="dt">data=</span>KWDYZ)), <span class="dt">corr=</span><span class="ot">FALSE</span>)  </code></pre>
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: prt ~ 1 + c1 + c2 + c3 + (1 + c1 + c2 + c3 | subj)
   Data: KWDYZ

     AIC      BIC   logLik deviance df.resid 
 80759.9  80883.9 -40365.0  80729.9    28695 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.9579 -0.5379 -0.0356  0.5127  4.9268 

Random effects:
 Groups   Name        Variance Std.Dev. Corr             
 subj     (Intercept) 0.57305  0.7570                    
          c1          0.09679  0.3111    0.53            
          c2          0.02072  0.1439   -0.19 -0.09      
          c3          0.01683  0.1297   -0.28 -0.90  0.40
 Residual             0.95703  0.9783                    
Number of obs: 28710, groups:  subj, 61

Fixed effects:
            Estimate Std. Error t value
(Intercept) 12.47414    0.09726  128.25
c1           0.46310    0.04437   10.44
c2           0.19251    0.03179    6.06
c3           0.04232    0.03077    1.38</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">rePCA</span>(m2j))</code></pre>
<pre><code>$subj
Importance of components:
                         [,1]   [,2]    [,3] [,4]
Standard deviation     0.7965 0.2862 0.15085    0
Proportion of Variance 0.8584 0.1108 0.03079    0
Cumulative Proportion  0.8584 0.9692 1.00000    1</code></pre>
<p>Transformed dependent variables also yield degenerate models, indicated by the cumulative proportion of variance reaching 1.0 at the 3rd principal component.</p>
</div>
</div>
<div id="package-versions" class="section level2">
<h2>Package Versions</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre>
<pre><code>R version 3.1.3 (2015-03-09)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.10

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RePsychLing_0.0.3 knitr_1.9.5       lme4_1.1-8        Rcpp_0.11.5      
[5] Matrix_1.1-5     

loaded via a namespace (and not attached):
 [1] digest_0.6.8    evaluate_0.5.5  formatR_1.0     grid_3.1.3      htmltools_0.2.6
 [6] lattice_0.20-30 MASS_7.3-40     minqa_1.2.4     nlme_3.1-120    nloptr_1.0.4   
[11] rmarkdown_0.5.1 splines_3.1.3   stringr_0.6.2   tools_3.1.3     yaml_2.1.13    </code></pre>
<div class="references">
<h2>References</h2>
<p>Kliegl, R., P. Wei, M. Dambacher, M. Yan, and X. Zhou. 2011. “Experimental Effects and Individual Differences in Linear Mixed Models: Estimating the Relationship Between Spatial, Object, and Attraction Effects in Visual Attention.” <em>Frontiers in Psychology</em> 1: 1–12.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
